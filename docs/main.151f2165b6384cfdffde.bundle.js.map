{"version":3,"file":"main.151f2165b6384cfdffde.bundle.js","mappings":"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","sources":["webpack://peta-wisata-indonesia/./src/scripts/utils/drawer-initiator.js","webpack://peta-wisata-indonesia/./src/scripts/routes/url-parser.js","webpack://peta-wisata-indonesia/./src/scripts/config.js","webpack://peta-wisata-indonesia/./src/scripts/utils/storage.js","webpack://peta-wisata-indonesia/./src/scripts/data/api.js","webpack://peta-wisata-indonesia/./src/scripts/utils/idb-helper.js","webpack://peta-wisata-indonesia/./src/scripts/pages/home/home-page.js","webpack://peta-wisata-indonesia/./src/scripts/routes/routes.js","webpack://peta-wisata-indonesia/./src/scripts/pages/about/about-page.js","webpack://peta-wisata-indonesia/./src/scripts/pages/auth/login-page.js","webpack://peta-wisata-indonesia/./src/scripts/pages/auth/register-page.js","webpack://peta-wisata-indonesia/./src/scripts/pages/story/add-story-page.js","webpack://peta-wisata-indonesia/./src/scripts/utils/leaflet-init.js","webpack://peta-wisata-indonesia/./src/scripts/pages/story/detail-story-page.js","webpack://peta-wisata-indonesia/./src/scripts/pages/favorites/favorites-page.js","webpack://peta-wisata-indonesia/./src/scripts/pages/app.js","webpack://peta-wisata-indonesia/./src/scripts/utils/push-notification.js","webpack://peta-wisata-indonesia/./src/scripts/utils/notification-helper.js","webpack://peta-wisata-indonesia/./src/scripts/utils/install-prompt.js","webpack://peta-wisata-indonesia/./src/scripts/index.js","webpack://peta-wisata-indonesia/./src/scripts/utils/sw-register.js"],"sourcesContent":["const DrawerInitiator = {\r\n  init({ button, drawer, content }) {\r\n    // Validasi elemen\r\n    if (!button || !drawer) {\r\n      console.error('DrawerInitiator: Button or drawer element not found');\r\n      return;\r\n    }\r\n\r\n    // Buat overlay backdrop\r\n    this._createOverlay(drawer);\r\n\r\n    // Toggle drawer saat button diklik\r\n    button.addEventListener('click', (event) => {\r\n      event.stopPropagation();\r\n      this._toggleDrawer(drawer);\r\n      console.log('Hamburger clicked, drawer toggled');\r\n    });\r\n\r\n    // Tutup drawer saat klik link navigasi\r\n    const navLinks = drawer.querySelectorAll('a');\r\n    console.log('Found nav links:', navLinks.length);\r\n\r\n    navLinks.forEach((link, index) => {\r\n      link.addEventListener('click', (event) => {\r\n        console.log(`Nav link ${index} clicked:`, link.href);\r\n\r\n        // Tutup drawer setelah klik\r\n        setTimeout(() => {\r\n          this._closeDrawer(drawer);\r\n        }, 100);\r\n      });\r\n    });\r\n\r\n    // Tutup drawer dengan tombol ESC\r\n    document.addEventListener('keydown', (event) => {\r\n      if (event.key === 'Escape') {\r\n        this._closeDrawer(drawer);\r\n      }\r\n    });\r\n\r\n    console.log('Drawer initialized ‚úÖ');\r\n  },\r\n\r\n  _toggleDrawer(drawer) {\r\n    const overlay = document.getElementById('drawer-overlay');\r\n    const button = document.getElementById('hamburgerButton');\r\n    const isOpen = drawer.classList.contains('open');\r\n\r\n    if (isOpen) {\r\n      this._closeDrawer(drawer);\r\n    } else {\r\n      drawer.classList.add('open');\r\n      overlay?.classList.add('open');\r\n      button?.classList.add('active');\r\n      document.body.style.overflow = 'hidden';\r\n      console.log('Drawer opened');\r\n    }\r\n  },\r\n\r\n  _closeDrawer(drawer) {\r\n    const overlay = document.getElementById('drawer-overlay');\r\n    const button = document.getElementById('hamburgerButton');\r\n    drawer.classList.remove('open');\r\n    overlay?.classList.remove('open');\r\n    button?.classList.remove('active');\r\n    document.body.style.overflow = '';\r\n    console.log('Drawer closed');\r\n  },\r\n\r\n  _createOverlay(drawer) {\r\n    // Cek apakah overlay sudah ada\r\n    if (document.getElementById('drawer-overlay')) {\r\n      return;\r\n    }\r\n\r\n    // Buat overlay element\r\n    const overlay = document.createElement('div');\r\n    overlay.id = 'drawer-overlay';\r\n    overlay.className = 'drawer-overlay';\r\n\r\n    // Tambahkan ke body\r\n    document.body.appendChild(overlay);\r\n\r\n    // Event listener untuk menutup drawer saat klik overlay\r\n    overlay.addEventListener('click', () => {\r\n      console.log('Overlay clicked');\r\n      this._closeDrawer(drawer);\r\n    });\r\n\r\n    console.log('Overlay created');\r\n  },\r\n};\r\n\r\nexport default DrawerInitiator;","class UrlParser {\n  static parseActiveUrlWithCombiner() {\n    const url = window.location.hash.slice(1).toLowerCase();\n    const splitedUrl = this._urlSplitter(url);\n\n    let combiner = '/';\n    if (splitedUrl.resource) {\n      combiner = `/${splitedUrl.resource}`;\n      if (splitedUrl.id) {\n        combiner += '/:id';\n      }\n      if (splitedUrl.verb) {\n        combiner += `/${splitedUrl.verb}`;\n      }\n    }\n\n    return combiner;\n  }\n\n  static parseActiveUrlWithoutCombiner() {\n    const hash = window.location.hash || '';\n    const url = hash.startsWith('#') ? hash.slice(1).toLowerCase() : hash.toLowerCase();\n    return this._urlSplitter(url);\n  }\n\n  static _urlSplitter(url) {\n    // pastikan tidak ada double slash, lalu bagi berdasarkan \"/\"\n    const cleanUrl = url.replace(/\\/+/g, '/');\n    const urlsSplits = cleanUrl.split('/').filter(Boolean);\n\n    return {\n      resource: urlsSplits[0] || null,\n      id: urlsSplits[1] || null,\n      verb: urlsSplits[2] || null,\n    };\n  }\n}\n\nexport default UrlParser;\n","const CONFIG = {\n  BASE_URL: 'https://story-api.dicoding.dev/v1/',\n  API_ENDPOINT: {\n    REGISTER: 'register',\n    LOGIN: 'login',\n    ALL_STORIES: 'stories',\n    ADD_STORY: 'stories',\n    DETAIL_STORY: (id) => `stories/${id}`,\n  },\n  MAP_CONFIG: {\n    DEFAULT_COORDINATE: [-6.2, 106.816666], // Jakarta\n    DEFAULT_ZOOM: 10,\n  },\n  PUSH_NOTIFICATION: {\n    PUBLIC_VAPID_KEY: 'BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk',\n    SERVER_URL: 'https://story-api.dicoding.dev/v1/notifications',\n  },\n};\n\nexport default CONFIG; ","const TOKEN_KEY = 'dicoding_story_token';\r\nconst USER_KEY = 'dicoding_story_user';\r\n\r\nexport const saveToken = (token) => {\r\n  localStorage.setItem(TOKEN_KEY, token);\r\n};\r\n\r\nexport const getToken = () => {\r\n  return localStorage.getItem(TOKEN_KEY);\r\n};\r\n\r\nexport const getUserToken = getToken; // Alias\r\n\r\nexport const clearToken = () => {\r\n  localStorage.removeItem(TOKEN_KEY);\r\n};\r\n\r\nexport const saveUser = (user) => {\r\n  localStorage.setItem(USER_KEY, JSON.stringify(user));\r\n};\r\n\r\nexport const getUser = () => {\r\n  const user = localStorage.getItem(USER_KEY);\r\n  return user ? JSON.parse(user) : null;\r\n};\r\n\r\nexport const clearUser = () => {\r\n  localStorage.removeItem(USER_KEY);\r\n};\r\n\r\nexport const clearAll = () => {\r\n  clearToken();\r\n  clearUser();\r\n};\r\n\r\nexport default {\r\n  saveToken,\r\n  getToken,\r\n  getUserToken,\r\n  clearToken,\r\n  saveUser,\r\n  getUser,\r\n  clearUser,\r\n  clearAll,\r\n};","import CONFIG from '../config.js';\nimport { getUser, saveUser } from '../utils/storage.js';\n\nclass DicodingAPI {\n  static async registerUser({ name, email, password }) {\n    try {\n      const response = await fetch(`${CONFIG.BASE_URL}${CONFIG.API_ENDPOINT.REGISTER}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ name, email, password }),\n      });\n\n      const result = await response.json();\n      if (!response.ok) throw new Error(result.message);\n      return result;\n    } catch (error) {\n      console.error('Register Error:', error);\n      throw error;\n    }\n  }\n\n  static async loginUser({ email, password }) {\n    try {\n      const response = await fetch(`${CONFIG.BASE_URL}${CONFIG.API_ENDPOINT.LOGIN}`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ email, password }),\n      });\n\n      const result = await response.json();\n      if (!response.ok) throw new Error(result.message);\n\n      // Simpan user token di storage\n      saveUser({\n        name: result.loginResult.name,\n        email,\n        token: result.loginResult.token,\n      });\n\n      return result;\n    } catch (error) {\n      console.error('Login Error:', error);\n      throw error;\n    }\n  }\n\n  static async getAllStories() {\n    try {\n      const user = getUser();\n      if (!user || !user.token) throw new Error('User belum login.');\n\n      const response = await fetch(\n        `${CONFIG.BASE_URL}${CONFIG.API_ENDPOINT.ALL_STORIES}?t=${Date.now()}`,\n        {\n          headers: { Authorization: `Bearer ${user.token}` },\n        }\n      );\n\n      const result = await response.json();\n      if (!response.ok) throw new Error(result.message);\n      return result.listStory;\n    } catch (error) {\n      console.error('Get Stories Error:', error);\n      throw error;\n    }\n  }\n\n  static async addStory({ description, photo, lat, lon }) {\n    try {\n      const user = getUser();\n      if (!user || !user.token) throw new Error('User belum login.');\n\n      const formData = new FormData();\n      formData.append('description', description);\n      formData.append('photo', photo);\n      if (lat && lon) {\n        formData.append('lat', lat);\n        formData.append('lon', lon);\n      }\n\n      const response = await fetch(`${CONFIG.BASE_URL}${CONFIG.API_ENDPOINT.ADD_STORY}`, {\n        method: 'POST',\n        headers: {\n          Authorization: `Bearer ${user.token}`,\n        },\n        body: formData,\n      });\n\n      const result = await response.json();\n      if (!response.ok) throw new Error(result.message);\n      return result;\n    } catch (error) {\n      console.error('Add Story Error:', error);\n      throw error;\n    }\n  }\n\n  static async getStoryDetail(id) {\n    try {\n      const user = getUser();\n      console.log('[DEBUG] Token user:', user?.token);\n      if (!user || !user.token) throw new Error('User belum login.');\n\n      const response = await fetch(`${CONFIG.BASE_URL}${CONFIG.API_ENDPOINT.DETAIL_STORY(id)}?t=${Date.now()}`, {\n        headers: { Authorization: `Bearer ${user.token}` },\n      });\n\n      const result = await response.json();\n      if (!response.ok) throw new Error(result.message || 'Story not found.');\n      return result.story;\n    } catch (error) {\n      console.error('Get Story Detail Error:', error);\n      throw error;\n    }\n  }\n\n  static async getUserProfile() {\n    const user = getUser();\n    return user || null;\n  }\n}\n\nexport default DicodingAPI;\n","const DB_NAME = 'peta-wisata-db';\r\nconst DB_VERSION = 1;\r\nconst STORE_NAME = 'favorites';\r\n\r\n/**\r\n * Inisialisasi database IndexedDB menggunakan native API\r\n */\r\nconst openDatabase = () => {\r\n    return new Promise((resolve, reject) => {\r\n        const request = indexedDB.open(DB_NAME, DB_VERSION);\r\n\r\n        request.onerror = () => {\r\n            reject(new Error('Failed to open database'));\r\n        };\r\n\r\n        request.onsuccess = (event) => {\r\n            resolve(event.target.result);\r\n        };\r\n\r\n        request.onupgradeneeded = (event) => {\r\n            const db = event.target.result;\r\n\r\n            if (!db.objectStoreNames.contains(STORE_NAME)) {\r\n                const store = db.createObjectStore(STORE_NAME, { keyPath: 'id' });\r\n                store.createIndex('createdAt', 'createdAt', { unique: false });\r\n            }\r\n        };\r\n    });\r\n};\r\n\r\nconst FavoriteIDB = {\r\n    /**\r\n     * Menambahkan story ke favorit\r\n     * @param {Object} story - Story object yang akan disimpan\r\n     * @returns {Promise<string>} ID dari story yang disimpan\r\n     */\r\n    async addFavorite(story) {\r\n        try {\r\n            const db = await openDatabase();\r\n            const favoriteData = {\r\n                id: story.id,\r\n                name: story.name,\r\n                description: story.description,\r\n                photoUrl: story.photoUrl,\r\n                lat: story.lat,\r\n                lon: story.lon,\r\n                createdAt: story.createdAt || new Date().toISOString(),\r\n            };\r\n\r\n            return new Promise((resolve, reject) => {\r\n                const transaction = db.transaction([STORE_NAME], 'readwrite');\r\n                const store = transaction.objectStore(STORE_NAME);\r\n                const request = store.put(favoriteData);\r\n\r\n                request.onsuccess = () => {\r\n                    console.log('Story added to favorites:', favoriteData);\r\n                    resolve(story.id);\r\n                };\r\n\r\n                request.onerror = () => {\r\n                    reject(new Error('Failed to add favorite'));\r\n                };\r\n            });\r\n        } catch (error) {\r\n            console.error('Error adding to favorites:', error);\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Mendapatkan semua favorit\r\n     * @returns {Promise<Array>} Array of favorite stories\r\n     */\r\n    async getAllFavorites() {\r\n        try {\r\n            const db = await openDatabase();\r\n\r\n            return new Promise((resolve, reject) => {\r\n                const transaction = db.transaction([STORE_NAME], 'readonly');\r\n                const store = transaction.objectStore(STORE_NAME);\r\n                const request = store.getAll();\r\n\r\n                request.onsuccess = () => {\r\n                    console.log('All favorites:', request.result);\r\n                    resolve(request.result);\r\n                };\r\n\r\n                request.onerror = () => {\r\n                    reject(new Error('Failed to get favorites'));\r\n                };\r\n            });\r\n        } catch (error) {\r\n            console.error('Error getting favorites:', error);\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Mendapatkan satu favorit berdasarkan ID\r\n     * @param {string} id - ID dari story\r\n     * @returns {Promise<Object|undefined>} Story object atau undefined jika tidak ditemukan\r\n     */\r\n    async getFavorite(id) {\r\n        try {\r\n            const db = await openDatabase();\r\n\r\n            return new Promise((resolve, reject) => {\r\n                const transaction = db.transaction([STORE_NAME], 'readonly');\r\n                const store = transaction.objectStore(STORE_NAME);\r\n                const request = store.get(id);\r\n\r\n                request.onsuccess = () => {\r\n                    resolve(request.result);\r\n                };\r\n\r\n                request.onerror = () => {\r\n                    reject(new Error('Failed to get favorite'));\r\n                };\r\n            });\r\n        } catch (error) {\r\n            console.error('Error getting favorite:', error);\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Menghapus story dari favorit\r\n     * @param {string} id - ID dari story yang akan dihapus\r\n     * @returns {Promise<void>}\r\n     */\r\n    async deleteFavorite(id) {\r\n        try {\r\n            const db = await openDatabase();\r\n\r\n            return new Promise((resolve, reject) => {\r\n                const transaction = db.transaction([STORE_NAME], 'readwrite');\r\n                const store = transaction.objectStore(STORE_NAME);\r\n                const request = store.delete(id);\r\n\r\n                request.onsuccess = () => {\r\n                    console.log('Story removed from favorites:', id);\r\n                    resolve();\r\n                };\r\n\r\n                request.onerror = () => {\r\n                    reject(new Error('Failed to delete favorite'));\r\n                };\r\n            });\r\n        } catch (error) {\r\n            console.error('Error deleting favorite:', error);\r\n            throw error;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Mengecek apakah story sudah ada di favorit\r\n     * @param {string} id - ID dari story\r\n     * @returns {Promise<boolean>} true jika sudah favorit, false jika belum\r\n     */\r\n    async isFavorite(id) {\r\n        try {\r\n            const favorite = await this.getFavorite(id);\r\n            return !!favorite;\r\n        } catch (error) {\r\n            console.error('Error checking favorite:', error);\r\n            return false;\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Toggle favorit (tambah jika belum ada, hapus jika sudah ada)\r\n     * @param {Object} story - Story object\r\n     * @returns {Promise<boolean>} true jika ditambahkan, false jika dihapus\r\n     */\r\n    async toggleFavorite(story) {\r\n        try {\r\n            const isFav = await this.isFavorite(story.id);\r\n\r\n            if (isFav) {\r\n                await this.deleteFavorite(story.id);\r\n                return false;\r\n            } else {\r\n                await this.addFavorite(story);\r\n                return true;\r\n            }\r\n        } catch (error) {\r\n            console.error('Error toggling favorite:', error);\r\n            throw error;\r\n        }\r\n    },\r\n};\r\n\r\nexport default FavoriteIDB;\r\n","import API from '../../data/api.js';\nimport CONFIG from '../../config.js';\nimport FavoriteIDB from '../../utils/idb-helper.js';\n\nconst HomePage = {\n  async render() {\n    return `\n      <section class=\"home-page\">\n        <h2>üåè Peta Lokasi Wisata Indonesia</h2>\n        <p>\n          Temukan dan jelajahi berbagai destinasi wisata menarik di seluruh Indonesia, lengkap dengan lokasi peta dan cerita dari para wisatawan.\n        </p>\n\n        <div id=\"map-home\" class=\"map-container\"></div>\n\n        <div class=\"section-header\" style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;\">\n          <h3 style=\"font-size: 1.75rem; color: var(--text-main);\">üó∫Ô∏è Daftar Lokasi Wisata</h3>\n          <div style=\"display: flex; gap: 1rem; align-items: center;\">\n            <button id=\"reload-btn\" class=\"btn-secondary\" style=\"padding: 0.75rem 1.5rem; background-color: #64748b; color: white; border: none; border-radius: 0.5rem; cursor: pointer; display: flex; align-items: center; gap: 0.5rem;\">\n              üîÑ Reload\n            </button>\n            <a href=\"#/add-story\" class=\"btn-primary\" style=\"width: auto; padding: 0.75rem 1.5rem; text-decoration: none;\">\n              + Tambah Cerita\n            </a>\n          </div>\n        </div>\n\n        <div id=\"story-list\" class=\"story-list\"></div>\n      </section>\n    `;\n  },\n\n  async afterRender() {\n    console.log('HomePage afterRender called');\n\n    // Inisialisasi map\n    this.map = L.map('map-home').setView(\n      CONFIG.MAP_CONFIG.DEFAULT_COORDINATE,\n      CONFIG.MAP_CONFIG.DEFAULT_ZOOM\n    );\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      attribution:\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\n    }).addTo(this.map);\n\n    this.markerLayer = L.layerGroup().addTo(this.map);\n\n    // Setup Reload Button\n    const reloadBtn = document.querySelector('#reload-btn');\n    if (reloadBtn) {\n      reloadBtn.addEventListener('click', async () => {\n        reloadBtn.disabled = true;\n        reloadBtn.innerHTML = 'üîÑ Loading...';\n        await this._loadStories();\n        reloadBtn.disabled = false;\n        reloadBtn.innerHTML = 'üîÑ Reload';\n      });\n    }\n\n    await this._loadStories();\n  },\n\n  async _loadStories() {\n    try {\n      const stories = await API.getAllStories();\n      console.log('Stories fetched:', stories);\n\n      const storyList = document.querySelector('#story-list');\n      storyList.innerHTML = ''; // Clear list\n      this.markerLayer.clearLayers(); // Clear markers\n\n      if (!stories || stories.length === 0) {\n        storyList.innerHTML = `\n          <div class=\"error-message\">\n            Tidak ada cerita ditemukan.\n          </div>\n        `;\n        return;\n      }\n\n      // Render setiap story\n      for (const story of stories) {\n        const storyElement = document.createElement('div');\n        storyElement.classList.add('story-card');\n\n        const storyId = story.id;\n\n        // Check if already favorited\n        const isFavorited = await FavoriteIDB.isFavorite(storyId);\n        const heartIcon = isFavorited ? '‚ù§Ô∏è' : 'ü§ç';\n\n        storyElement.innerHTML = `\n          <div style=\"position: absolute; top: 10px; right: 10px; z-index: 10;\">\n            <button class=\"favorite-btn\" data-story-id=\"${storyId}\" aria-label=\"Toggle favorite\" style=\"background: rgba(255, 255, 255, 0.9); border: none; border-radius: 50%; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center; cursor: pointer; box-shadow: 0 2px 4px rgba(0,0,0,0.2);\">\n              <span class=\"heart-icon\" style=\"font-size: 1.2rem;\">${heartIcon}</span>\n            </button>\n          </div>\n          <img src=\"${story.photoUrl}\" alt=\"${story.name}\" loading=\"lazy\" />\n          <div class=\"story-info\">\n            <h3>${story.name}</h3>\n            <span class=\"story-date\">${new Date(story.createdAt).toLocaleDateString('id-ID', {\n          day: 'numeric',\n          month: 'long',\n          year: 'numeric',\n        })}</span>\n            <p>${story.description.substring(0, 100)}...</p>\n            <a href=\"#/story/${storyId}\" data-story-id=\"${storyId}\">\n               Lihat Detail\n            </a>\n          </div>\n        `;\n\n        storyList.appendChild(storyElement);\n\n        // Add favorite button event listener\n        const favoriteBtn = storyElement.querySelector('.favorite-btn');\n        favoriteBtn.addEventListener('click', async (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n\n          try {\n            const isNowFavorited = await FavoriteIDB.toggleFavorite(story);\n            const heartIcon = favoriteBtn.querySelector('.heart-icon');\n            heartIcon.textContent = isNowFavorited ? '‚ù§Ô∏è' : 'ü§ç';\n\n            // Show notification\n            this._showNotification(\n              isNowFavorited ? 'Ditambahkan ke favorit!' : 'Dihapus dari favorit!',\n              isNowFavorited ? 'success' : 'info'\n            );\n          } catch (error) {\n            console.error('Error toggling favorite:', error);\n            this._showNotification('Gagal mengubah favorit', 'error');\n          }\n        });\n\n        // Tambahkan marker ke peta\n        if (story.lat && story.lon) {\n          L.marker([story.lat, story.lon])\n            .addTo(this.markerLayer)\n            .bindPopup(`\n              <div class=\"leaflet-popup-content\">\n                <img src=\"${story.photoUrl}\" alt=\"${story.name}\" />\n                <h4>${story.name}</h4>\n                <p>${story.description.substring(0, 80)}...</p>\n                <a href=\"#/story/${storyId}\">Lihat Detail</a>\n              </div>\n            `);\n        }\n      }\n    } catch (error) {\n      console.error('Error in HomePage:', error);\n      const storyList = document.querySelector('#story-list');\n\n      if (error.message && error.message.includes('Invalid token')) {\n        storyList.innerHTML = `\n          <div class=\"text-center py-10\">\n            <p class=\"text-red-600 font-medium mb-2\">Token login tidak valid. Silakan login ulang.</p>\n            <a href=\"#/login\" class=\"text-blue-600 hover:text-blue-800 underline\">Login di sini</a>\n          </div>\n        `;\n        localStorage.removeItem('token');\n      } else {\n        storyList.innerHTML = '<p class=\"text-center text-gray-500 py-10\">Gagal memuat cerita.</p>';\n      }\n    }\n  },\n\n  _showNotification(message, type = 'info') {\n    const notification = document.createElement('div');\n    notification.className = `notification notification-${type}`;\n    notification.textContent = message;\n    notification.style.cssText = `\n      position: fixed;\n      top: 80px;\n      right: 20px;\n      background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};\n      color: white;\n      padding: 1rem 1.5rem;\n      border-radius: 0.5rem;\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n      z-index: 10000;\n      animation: slideIn 0.3s ease-out;\n    `;\n\n    document.body.appendChild(notification);\n\n    setTimeout(() => {\n      notification.style.animation = 'slideOut 0.3s ease-out';\n      setTimeout(() => notification.remove(), 300);\n    }, 3000);\n  },\n};\n\nexport default HomePage;","import HomePage from '../pages/home/home-page.js';\nimport AboutPage from '../pages/about/about-page.js';\nimport LoginPage from '../pages/auth/login-page.js';\nimport RegisterPage from '../pages/auth/register-page.js';\nimport AddStoryPage from '../pages/story/add-story-page.js';\nimport DetailStoryPage from '../pages/story/detail-story-page.js';\nimport FavoritesPage from '../pages/favorites/favorites-page.js';\n\nconst routes = {\n  '/': HomePage,\n  '/home': HomePage,\n  '/about': AboutPage,\n  '/login': LoginPage,\n  '/register': RegisterPage,\n  '/add-story': AddStoryPage,\n  '/story/:id': DetailStoryPage,\n  '/favorites': FavoritesPage,\n};\n\nexport default routes;\n\n","const AboutPage = {\n  async render() {\n    return `\n      <section class=\"about-page\">\n        <h2>Tentang Aplikasi</h2>\n        <p>Aplikasi ini adalah platform untuk berbagi cerita wisata di Indonesia menggunakan peta interaktif. Dibangun dengan teknologi modern seperti Leaflet untuk peta dan API Dicoding untuk autentikasi.</p>\n        <p>Temukan destinasi wisata terbaik dan bagikan pengalaman Anda kepada dunia!</p>\n      </section>\n    `;\n  },\n\n  async afterRender() {\n    // Tidak ada logika khusus\n  },\n};\n\nexport default AboutPage;","import API from '../../data/api.js';\r\nimport { saveUser } from '../../utils/storage.js';\r\n\r\nconst LoginPage = {\r\n  async render() {\r\n    return `\r\n      <section class=\"auth-page\">\r\n        <h2>Login</h2>\r\n        <h2 class=\"sr-only\">Form Login Pengguna</h2>\r\n        <form id=\"loginForm\" class=\"auth-form\">\r\n          <div class=\"form-group\">\r\n            <label for=\"email\">Email</label>\r\n            <input id=\"email\" type=\"email\" required aria-required=\"true\" />\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"password\">Password</label>\r\n            <input id=\"password\" type=\"password\" required aria-required=\"true\" />\r\n          </div>\r\n          <button type=\"submit\" class=\"btn-primary\">Login</button>\r\n          <p>Belum punya akun? <a href=\"#/register\">Register</a></p>\r\n        </form>\r\n        <div id=\"error-message\" class=\"error-message\" role=\"alert\"></div>\r\n      </section>\r\n    `;\r\n  },\r\n\r\n  async afterRender() {\r\n    const form = document.querySelector('#loginForm');\r\n    const errorDiv = document.querySelector('#error-message');\r\n\r\n    form.addEventListener('submit', async (e) => {\r\n      e.preventDefault();\r\n      const email = document.querySelector('#email').value.trim();\r\n      const password = document.querySelector('#password').value.trim();\r\n\r\n      if (!email || !password) {\r\n        errorDiv.textContent = 'Email dan password wajib diisi.';\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const result = await API.loginUser({ email, password });\r\n        saveUser({\r\n          name: result.loginResult.name,\r\n          email,\r\n          token: result.loginResult.token,\r\n        });\r\n        window.location.hash = '/';\r\n      } catch (error) {\r\n        errorDiv.textContent = error.message || 'Login gagal.';\r\n      }\r\n    });\r\n  },\r\n};\r\n\r\nexport default LoginPage;","import API from '../../data/api.js';\r\n\r\nconst RegisterPage = {\r\n  async render() {\r\n    return `\r\n      <section class=\"auth-page\">\r\n        <h2>Register</h2>\r\n        <h2 class=\"sr-only\">Form Registrasi Pengguna Baru</h2>\r\n        <form id=\"registerForm\" class=\"auth-form\">\r\n          <div class=\"form-group\">\r\n            <label for=\"name\">Nama</label>\r\n            <input id=\"name\" type=\"text\" required aria-required=\"true\" />\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"email\">Email</label>\r\n            <input id=\"email\" type=\"email\" required aria-required=\"true\" />\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"password\">Password</label>\r\n            <input id=\"password\" type=\"password\" required aria-required=\"true\" />\r\n          </div>\r\n          <button type=\"submit\" class=\"btn-primary\">Register</button>\r\n          <p>Sudah punya akun? <a href=\"#/login\">Login</a></p>\r\n        </form>\r\n        <div id=\"error-message\" class=\"error-message\" role=\"alert\"></div>\r\n      </section>\r\n    `;\r\n  },\r\n\r\n  async afterRender() {\r\n    const form = document.querySelector('#registerForm');\r\n    const errorDiv = document.querySelector('#error-message');\r\n\r\n    form.addEventListener('submit', async (e) => {\r\n      e.preventDefault();\r\n      const name = document.querySelector('#name').value.trim();\r\n      const email = document.querySelector('#email').value.trim();\r\n      const password = document.querySelector('#password').value.trim();\r\n\r\n      if (!name || !email || !password) {\r\n        errorDiv.textContent = 'Semua field wajib diisi.';\r\n        return;\r\n      }\r\n\r\n      try {\r\n        await API.registerUser({ name, email, password });\r\n        alert('Registrasi berhasil! Silakan login.');\r\n        window.location.hash = '/login';\r\n      } catch (error) {\r\n        errorDiv.textContent = error.message || 'Registrasi gagal.';\r\n      }\r\n    });\r\n  },\r\n};\r\n\r\nexport default RegisterPage;","import API from '../../data/api.js';\r\nimport { getUser } from '../../utils/storage.js';\r\nimport { initMapPicker } from '../../utils/leaflet-init.js';\r\n\r\nconst AddStoryPage = {\r\n  async render() {\r\n    return `\r\n      <section class=\"add-story-page\">\r\n        <h2>Tambah Cerita Baru</h2>\r\n        <h2 class=\"sr-only\">Form Tambah Cerita Wisata</h2>\r\n        <form id=\"storyForm\" class=\"story-form\" enctype=\"multipart/form-data\">\r\n          <div class=\"form-group\">\r\n            <label for=\"description\">Deskripsi</label>\r\n            <textarea id=\"description\" rows=\"4\" placeholder=\"Tuliskan cerita anda...\" required aria-required=\"true\"></textarea>\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label for=\"photo\">Unggah Foto</label>\r\n            <input id=\"photo\" type=\"file\" accept=\"image/*\" required aria-required=\"true\" />\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label>Pilih Lokasi di Peta</label>\r\n            <div id=\"map-add\" class=\"map-select\" role=\"application\" aria-label=\"Peta untuk memilih lokasi\"></div>\r\n          </div>\r\n          <button type=\"submit\" class=\"btn-primary\">Kirim Cerita</button>\r\n        </form>\r\n      </section>\r\n    `;\r\n  },\r\n\r\n  async afterRender() {\r\n    const user = getUser();\r\n    if (!user || !user.token) {\r\n      alert('Silakan login terlebih dahulu untuk menambahkan cerita.');\r\n      window.location.hash = '/login';\r\n      return;\r\n    }\r\n\r\n    let selectedLat = null;\r\n    let selectedLng = null;\r\n    const map = initMapPicker('map-add', (lat, lng) => {\r\n      selectedLat = lat;\r\n      selectedLng = lng;\r\n    });\r\n\r\n    const form = document.querySelector('#storyForm');\r\n    form.addEventListener('submit', async (e) => {\r\n      e.preventDefault();\r\n\r\n      const description = document.querySelector('#description').value.trim();\r\n      const photoInput = document.querySelector('#photo').files[0];\r\n\r\n      if (!description || !photoInput || !selectedLat || !selectedLng) {\r\n        alert('Semua kolom wajib diisi, termasuk lokasi!');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const response = await API.addStory({\r\n          description,\r\n          photo: photoInput,\r\n          lat: selectedLat,\r\n          lon: selectedLng\r\n        });\r\n\r\n        if (!response.error) {\r\n          // ‚úÖ TRIGGER NOTIFICATION\r\n          await this.showSuccessNotification(description);\r\n\r\n          alert('Cerita berhasil ditambahkan!');\r\n          window.location.hash = '/';\r\n        } else {\r\n          alert(`Gagal: ${response.message}`);\r\n        }\r\n      } catch (error) {\r\n        alert('Terjadi kesalahan.');\r\n        console.error(error);\r\n      }\r\n    });\r\n  },\r\n\r\n  // ========================================\r\n  // Show Success Notification\r\n  // ========================================\r\n  async showSuccessNotification(description) {\r\n    try {\r\n      // Check if browser supports notifications\r\n      if (!('Notification' in window)) {\r\n        console.warn('Browser tidak support notifikasi');\r\n        return;\r\n      }\r\n\r\n      // Check permission\r\n      let permission = Notification.permission;\r\n\r\n      if (permission === 'default') {\r\n        permission = await Notification.requestPermission();\r\n      }\r\n\r\n      if (permission !== 'granted') {\r\n        console.warn('Notifikasi tidak diizinkan');\r\n        return;\r\n      }\r\n\r\n      // Get service worker registration\r\n      if ('serviceWorker' in navigator) {\r\n        const registration = await navigator.serviceWorker.ready;\r\n\r\n        // Show notification via service worker\r\n        await registration.showNotification('Cerita Berhasil Ditambahkan! üéâ', {\r\n          body: description.substring(0, 100) + '...',\r\n          icon: '/public/icons/icon-192x192.png',\r\n          badge: '/public/icons/icon-192x192.png',\r\n          tag: 'story-added',\r\n          requireInteraction: false,\r\n          vibrate: [200, 100, 200],\r\n          data: {\r\n            url: '/#/',\r\n            timestamp: Date.now(),\r\n          },\r\n          actions: [\r\n            {\r\n              action: 'view',\r\n              title: 'üëÅÔ∏è Lihat Cerita',\r\n            },\r\n            {\r\n              action: 'close',\r\n              title: '‚ùå Tutup',\r\n            },\r\n          ],\r\n        });\r\n\r\n        console.log('‚úÖ Notifikasi ditampilkan');\r\n      }\r\n    } catch (error) {\r\n      console.error('Error showing notification:', error);\r\n    }\r\n  },\r\n};\r\n\r\nexport default AddStoryPage;","import CONFIG from '../config.js';\r\n\r\nexport const initMapPicker = (mapId, onLocationSelect) => {\r\n  const map = L.map(mapId).setView(CONFIG.MAP_CONFIG.DEFAULT_COORDINATE, CONFIG.MAP_CONFIG.DEFAULT_ZOOM);\r\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n  }).addTo(map);\r\n\r\n  let marker;\r\n  map.on('click', (e) => {\r\n    const { lat, lng } = e.latlng;\r\n    if (marker) map.removeLayer(marker);\r\n    marker = L.marker([lat, lng]).addTo(map);\r\n    onLocationSelect(lat, lng);\r\n  });\r\n  return map;\r\n};\r\n\r\nexport const initMapForStory = (lat, lon, mapId) => {\r\n  const map = L.map(mapId).setView([lat, lon], 15);\r\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n  }).addTo(map);\r\n  L.marker([lat, lon]).addTo(map);\r\n};","import API from '../../data/api.js';\r\nimport UrlParser from '../../routes/url-parser.js';\r\nimport { initMapForStory } from '../../utils/leaflet-init.js';\r\n\r\nconst DetailStoryPage = {\r\n  async render() {\r\n    return `\r\n      <section class=\"detail-story-page\">\r\n        <div id=\"story-detail\" class=\"story-detail\">\r\n          <div class=\"text-center py-10\">\r\n            <p>Memuat detail cerita...</p>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    `;\r\n  },\r\n\r\n  async afterRender() {\r\n    const url = UrlParser.parseActiveUrlWithoutCombiner();\r\n    const rawHash = window.location.hash;\r\n\r\n    console.log('[DetailStoryPage] Raw Hash:', rawHash);\r\n    console.log('[DetailStoryPage] Parsed URL:', url);\r\n\r\n    // Ambil ID langsung dari hash sebagai fallback\r\n    const hashParts = rawHash.replace('#/', '').split('/');\r\n    const idFromHash = hashParts[1]; // story/ID -> ambil index 1\r\n    const id = idFromHash || url.id;\r\n\r\n    console.log('[DetailStoryPage] Final Story ID to fetch:', id);\r\n\r\n    if (!id) {\r\n      document.querySelector('#story-detail').innerHTML = `\r\n        <h2>Detail Cerita</h2>\r\n        <p class=\"error-message\">‚ùå ID cerita tidak ditemukan di URL.</p>\r\n        <p class=\"text-muted\">URL: ${rawHash}</p>\r\n        <a href=\"#/\" class=\"btn-primary\" style=\"display: inline-block; width: auto; margin-top: 1rem; text-decoration: none;\">\r\n          ‚Üê Kembali ke Beranda\r\n        </a>\r\n      `;\r\n      return;\r\n    }\r\n\r\n    try {\r\n      console.log('[DetailStoryPage] Fetching story with ID:', id);\r\n      const story = await API.getStoryDetail(id);\r\n\r\n      if (!story) {\r\n        throw new Error('Cerita tidak ditemukan di server.');\r\n      }\r\n\r\n      const { name, description, photoUrl, lat, lon, createdAt } = story;\r\n\r\n      document.querySelector('#story-detail').innerHTML = `\r\n        <h2>${name}</h2>\r\n        <div class=\"story-card detail-content\">\r\n          <img src=\"${photoUrl}\" alt=\"${name}\" class=\"story-image\"/>\r\n          <div class=\"story-info\">\r\n            <span class=\"story-date\" style=\"font-size: 1rem; margin-bottom: 1.5rem;\">\r\n              üìÖ ${new Date(createdAt).toLocaleDateString('id-ID', {\r\n        day: 'numeric',\r\n        month: 'long',\r\n        year: 'numeric',\r\n      })}\r\n            </span>\r\n            <h3>Deskripsi</h3>\r\n            <p>${description}</p>\r\n            ${lat && lon ? `\r\n              <h3>Lokasi</h3>\r\n              <div id=\"map-detail\" class=\"map-container\"></div>\r\n            ` : ''}\r\n            <a href=\"#/\" class=\"btn-primary\" style=\"display: inline-block; width: auto; margin-top: 1.5rem; text-decoration: none;\">\r\n              ‚Üê Kembali ke Beranda\r\n            </a>\r\n          </div>\r\n        </div>\r\n      `;\r\n\r\n      if (lat && lon) {\r\n        // Tunggu sedikit agar DOM sudah ready\r\n        setTimeout(() => {\r\n          initMapForStory(lat, lon, 'map-detail');\r\n        }, 100);\r\n      }\r\n\r\n      console.log('[DetailStoryPage] ‚úÖ Cerita berhasil dimuat:', name);\r\n    } catch (error) {\r\n      console.error('[DetailStoryPage] ‚ùå Gagal memuat detail:', error);\r\n      document.querySelector('#story-detail').innerHTML = `\r\n        <h2>Detail Cerita</h2>\r\n        <div class=\"text-center py-10\">\r\n          <p class=\"error-message\">‚ùå Gagal memuat detail cerita.</p>\r\n          <p class=\"text-muted\"><strong>Error:</strong> ${error.message}</p>\r\n          <p class=\"text-muted\"><strong>Story ID:</strong> ${id}</p>\r\n          <p class=\"text-muted\"><strong>URL:</strong> ${rawHash}</p>\r\n          <a href=\"#/\" class=\"btn-primary\" style=\"display: inline-block; width: auto; margin-top: 1rem; text-decoration: none;\">\r\n            ‚Üê Kembali ke Beranda\r\n          </a>\r\n        </div>\r\n      `;\r\n    }\r\n  },\r\n};\r\n\r\nexport default DetailStoryPage;","import FavoriteIDB from '../../utils/idb-helper.js';\r\nimport CONFIG from '../../config.js';\r\n\r\nconst FavoritesPage = {\r\n    async render() {\r\n        return `\r\n      <section class=\"favorites-page\">\r\n        <div class=\"page-header\">\r\n          <h2>‚ù§Ô∏è Favorit Saya</h2>\r\n          <p>Daftar destinasi wisata yang telah Anda simpan sebagai favorit</p>\r\n        </div>\r\n\r\n        <div id=\"favorites-map\" class=\"map-container\"></div>\r\n\r\n        <div class=\"section-header\" style=\"margin-bottom: 2rem;\">\r\n          <h3 style=\"font-size: 1.75rem; color: var(--text-main);\">üìå Daftar Favorit</h3>\r\n          <span id=\"favorites-count\" class=\"badge\">0 Favorit</span>\r\n        </div>\r\n\r\n        <div id=\"favorites-list\" class=\"story-list\"></div>\r\n      </section>\r\n    `;\r\n    },\r\n\r\n    async afterRender() {\r\n        console.log('FavoritesPage afterRender called');\r\n\r\n        // Inisialisasi map\r\n        const map = L.map('favorites-map').setView(\r\n            CONFIG.MAP_CONFIG.DEFAULT_COORDINATE,\r\n            CONFIG.MAP_CONFIG.DEFAULT_ZOOM\r\n        );\r\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n            attribution:\r\n                '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\r\n        }).addTo(map);\r\n\r\n        // Load favorites dari IndexedDB\r\n        await this._loadFavorites(map);\r\n    },\r\n\r\n    async _loadFavorites(map) {\r\n        const favoritesList = document.querySelector('#favorites-list');\r\n        const favoritesCount = document.querySelector('#favorites-count');\r\n\r\n        try {\r\n            const favorites = await FavoriteIDB.getAllFavorites();\r\n            console.log('Favorites loaded:', favorites);\r\n\r\n            if (!favorites || favorites.length === 0) {\r\n                favoritesList.innerHTML = `\r\n          <div class=\"empty-state\">\r\n            <div style=\"font-size: 4rem; margin-bottom: 1rem;\">üíî</div>\r\n            <h3 style=\"color: var(--text-main); margin-bottom: 0.5rem;\">Belum Ada Favorit</h3>\r\n            <p style=\"color: var(--text-secondary); margin-bottom: 1.5rem;\">\r\n              Anda belum menyimpan destinasi wisata apapun sebagai favorit.\r\n            </p>\r\n            <a href=\"#/\" class=\"btn-primary\" style=\"text-decoration: none; display: inline-block;\">\r\n              Jelajahi Destinasi\r\n            </a>\r\n          </div>\r\n        `;\r\n                favoritesCount.textContent = '0 Favorit';\r\n                return;\r\n            }\r\n\r\n            // Update count\r\n            favoritesCount.textContent = `${favorites.length} Favorit`;\r\n\r\n            // Clear list\r\n            favoritesList.innerHTML = '';\r\n\r\n            // Render each favorite\r\n            favorites.forEach((story) => {\r\n                const storyElement = document.createElement('div');\r\n                storyElement.classList.add('story-card');\r\n                storyElement.dataset.storyId = story.id;\r\n\r\n                storyElement.innerHTML = `\r\n          <img src=\"${story.photoUrl}\" alt=\"${story.name}\" loading=\"lazy\" />\r\n          <div class=\"story-info\">\r\n            <h3>${story.name}</h3>\r\n            <p>${story.description.substring(0, 100)}...</p>\r\n            <div style=\"display: flex; gap: 0.5rem; margin-top: 1rem;\">\r\n              <a href=\"#/story/${story.id}\" class=\"btn-secondary\" style=\"text-decoration: none; flex: 1; text-align: center;\">\r\n                Lihat Detail\r\n              </a>\r\n              <button class=\"btn-remove-favorite\" data-id=\"${story.id}\" style=\"background: #ef4444; color: white; border: none; padding: 0.75rem 1rem; border-radius: 0.5rem; cursor: pointer; font-weight: 500;\">\r\n                üóëÔ∏è Hapus\r\n              </button>\r\n            </div>\r\n          </div>\r\n        `;\r\n\r\n                favoritesList.appendChild(storyElement);\r\n\r\n                // Add marker to map\r\n                if (story.lat && story.lon) {\r\n                    L.marker([story.lat, story.lon])\r\n                        .addTo(map)\r\n                        .bindPopup(`\r\n              <div class=\"leaflet-popup-content\">\r\n                <img src=\"${story.photoUrl}\" alt=\"${story.name}\" />\r\n                <h4>${story.name}</h4>\r\n                <p>${story.description.substring(0, 80)}...</p>\r\n                <a href=\"#/story/${story.id}\">Lihat Detail</a>\r\n              </div>\r\n            `);\r\n                }\r\n            });\r\n\r\n            // Add event listeners for remove buttons\r\n            this._initRemoveButtons(map);\r\n        } catch (error) {\r\n            console.error('Error loading favorites:', error);\r\n            favoritesList.innerHTML = `\r\n        <div class=\"error-message\">\r\n          <p>Gagal memuat favorit. Silakan coba lagi.</p>\r\n        </div>\r\n      `;\r\n        }\r\n    },\r\n\r\n    _initRemoveButtons(map) {\r\n        const removeButtons = document.querySelectorAll('.btn-remove-favorite');\r\n\r\n        removeButtons.forEach((button) => {\r\n            button.addEventListener('click', async (e) => {\r\n                const storyId = e.target.dataset.id;\r\n\r\n                // Konfirmasi sebelum menghapus\r\n                const confirmed = confirm('Apakah Anda yakin ingin menghapus dari favorit?');\r\n\r\n                if (confirmed) {\r\n                    try {\r\n                        await FavoriteIDB.deleteFavorite(storyId);\r\n\r\n                        // Show success message\r\n                        this._showNotification('Berhasil dihapus dari favorit!', 'success');\r\n\r\n                        // Reload favorites\r\n                        await this._loadFavorites(map);\r\n                    } catch (error) {\r\n                        console.error('Error removing favorite:', error);\r\n                        this._showNotification('Gagal menghapus dari favorit', 'error');\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    },\r\n\r\n    _showNotification(message, type = 'info') {\r\n        // Simple notification\r\n        const notification = document.createElement('div');\r\n        notification.className = `notification notification-${type}`;\r\n        notification.textContent = message;\r\n        notification.style.cssText = `\r\n      position: fixed;\r\n      top: 80px;\r\n      right: 20px;\r\n      background: ${type === 'success' ? '#10b981' : '#ef4444'};\r\n      color: white;\r\n      padding: 1rem 1.5rem;\r\n      border-radius: 0.5rem;\r\n      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\r\n      z-index: 10000;\r\n      animation: slideIn 0.3s ease-out;\r\n    `;\r\n\r\n        document.body.appendChild(notification);\r\n\r\n        setTimeout(() => {\r\n            notification.style.animation = 'slideOut 0.3s ease-out';\r\n            setTimeout(() => notification.remove(), 300);\r\n        }, 3000);\r\n    },\r\n};\r\n\r\nexport default FavoritesPage;\r\n","import DrawerInitiator from '../utils/drawer-initiator.js';\nimport UrlParser from '../routes/url-parser.js';\nimport routes from '../routes/routes.js';\n\nclass App {\n  constructor({ button, drawer, content }) {\n    this._button = button;\n    this._drawer = drawer;\n    this._content = content;\n\n    this._initAppShell();\n  }\n\n  _initAppShell() {\n    DrawerInitiator.init({\n      button: this._button,\n      drawer: this._drawer,\n      content: this._content,\n    });\n  }\n\n  async renderPage() {\n    const url = UrlParser.parseActiveUrlWithCombiner();\n    const page = routes[url];\n\n    console.log('üîç Current URL:', window.location.hash);\n    console.log('üîç Parsed URL:', url);\n    console.log('üîç Found page:', !!page);\n\n    if (!page) {\n      console.error('‚ùå Page not found for URL:', url);\n      this._content.innerHTML = '<h1>Halaman tidak ditemukan üò¢</h1>';\n      return;\n    }\n\n    console.log('‚úÖ Rendering page for:', url);\n\n    // üé¨ VIEW TRANSITION API\n    if ('startViewTransition' in document) {\n      console.log('üé¨ Using View Transition API');\n      \n      document.startViewTransition(async () => {\n        this._content.innerHTML = await page.render();\n        await page.afterRender?.();\n        console.log('‚úÖ Page rendered successfully');\n      });\n    } else {\n      console.warn('‚ö†Ô∏è View Transition API not supported');\n      this._content.innerHTML = await page.render();\n      await page.afterRender?.();\n      console.log('‚úÖ Page rendered successfully (fallback)');\n    }\n  }\n}\n\nexport default App;","import CONFIG from '../config.js';\r\n\r\nconst PushNotification = {\r\n  // ========================================\r\n  // Check Browser Support\r\n  // ========================================\r\n  isSupported() {\r\n    return 'serviceWorker' in navigator && 'PushManager' in window;\r\n  },\r\n\r\n  // ========================================\r\n  // Request Notification Permission\r\n  // ========================================\r\n  async requestPermission() {\r\n    if (!this.isSupported()) {\r\n      console.warn('Push notification tidak didukung di browser ini');\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const permission = await Notification.requestPermission();\r\n      console.log('Notification permission:', permission);\r\n\r\n      if (permission === 'granted') {\r\n        console.log('‚úÖ Notification permission granted');\r\n        return true;\r\n      } else if (permission === 'denied') {\r\n        console.warn('‚ùå Notification permission denied');\r\n        return false;\r\n      } else {\r\n        console.log('‚ö†Ô∏è Notification permission dismissed');\r\n        return false;\r\n      }\r\n    } catch (error) {\r\n      console.error('Error requesting notification permission:', error);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Convert VAPID Key to Uint8Array\r\n  // ========================================\r\n  urlBase64ToUint8Array(base64String) {\r\n    const padding = '='.repeat((4 - (base64String.length % 4)) % 4);\r\n    const base64 = (base64String + padding).replace(/-/g, '+').replace(/_/g, '/');\r\n\r\n    const rawData = window.atob(base64);\r\n    const outputArray = new Uint8Array(rawData.length);\r\n\r\n    for (let i = 0; i < rawData.length; ++i) {\r\n      outputArray[i] = rawData.charCodeAt(i);\r\n    }\r\n    return outputArray;\r\n  },\r\n\r\n  // ========================================\r\n  // Subscribe to Push Notifications\r\n  // ========================================\r\n  async subscribe() {\r\n    if (!this.isSupported()) {\r\n      throw new Error('Push notification tidak didukung');\r\n    }\r\n\r\n    try {\r\n      // 1. Get service worker registration\r\n      const registration = await navigator.serviceWorker.ready;\r\n      console.log('Service Worker ready for push subscription');\r\n\r\n      // 2. Check if already subscribed\r\n      let subscription = await registration.pushManager.getSubscription();\r\n\r\n      if (subscription) {\r\n        console.log('Already subscribed to push notifications');\r\n        // Send existing subscription to Dicoding API\r\n        await this.sendSubscriptionToDicodingAPI(subscription);\r\n        return subscription;\r\n      }\r\n\r\n      // 3. Request permission if needed\r\n      const hasPermission = await this.requestPermission();\r\n      if (!hasPermission) {\r\n        throw new Error('Permission tidak diberikan');\r\n      }\r\n\r\n      // 4. Subscribe with VAPID key\r\n      const vapidPublicKey = CONFIG.PUSH_NOTIFICATION.PUBLIC_VAPID_KEY;\r\n      const convertedVapidKey = this.urlBase64ToUint8Array(vapidPublicKey);\r\n\r\n      subscription = await registration.pushManager.subscribe({\r\n        userVisibleOnly: true,\r\n        applicationServerKey: convertedVapidKey,\r\n      });\r\n\r\n      console.log('‚úÖ Push subscription created:', subscription);\r\n\r\n      // 5. Send subscription to Dicoding API\r\n      await this.sendSubscriptionToDicodingAPI(subscription);\r\n\r\n      // 6. Save status\r\n      localStorage.setItem('push_subscription_enabled', 'true');\r\n\r\n      return subscription;\r\n    } catch (error) {\r\n      console.error('Error subscribing to push:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Unsubscribe from Push Notifications\r\n  // ========================================\r\n  async unsubscribe() {\r\n    try {\r\n      const registration = await navigator.serviceWorker.ready;\r\n      const subscription = await registration.pushManager.getSubscription();\r\n\r\n      if (!subscription) {\r\n        console.log('Not subscribed to push notifications');\r\n        return;\r\n      }\r\n\r\n      // Delete from Dicoding API first\r\n      await this.deleteSubscriptionFromDicodingAPI(subscription);\r\n\r\n      // Then unsubscribe locally\r\n      await subscription.unsubscribe();\r\n      console.log('‚úÖ Unsubscribed from push notifications');\r\n\r\n      localStorage.setItem('push_subscription_enabled', 'false');\r\n    } catch (error) {\r\n      console.error('Error unsubscribing from push:', error);\r\n      throw error;\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Check Subscription Status\r\n  // ========================================\r\n  async getSubscriptionStatus() {\r\n    try {\r\n      const registration = await navigator.serviceWorker.ready;\r\n      const subscription = await registration.pushManager.getSubscription();\r\n      return !!subscription;\r\n    } catch (error) {\r\n      console.error('Error checking subscription status:', error);\r\n      return false;\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Send Subscription to Dicoding API\r\n  // ========================================\r\n  async sendSubscriptionToDicodingAPI(subscription) {\r\n    try {\r\n      const user = JSON.parse(localStorage.getItem('dicoding_story_user') || '{}');\r\n\r\n      if (!user || !user.token) {\r\n        console.warn('‚ö†Ô∏è User belum login, skip send subscription to API');\r\n        return;\r\n      }\r\n\r\n      // Convert subscription to JSON\r\n      const subscriptionJSON = subscription.toJSON();\r\n\r\n      // Format sesuai dokumentasi Dicoding API\r\n      const payload = {\r\n        endpoint: subscriptionJSON.endpoint,\r\n        keys: {\r\n          p256dh: subscriptionJSON.keys.p256dh,\r\n          auth: subscriptionJSON.keys.auth,\r\n        },\r\n      };\r\n\r\n      const endpoint = `${CONFIG.BASE_URL}notifications/subscribe`;\r\n\r\n      console.log('üì§ Sending subscription to Dicoding API:', endpoint);\r\n      console.log('üì¶ Payload:', payload);\r\n\r\n      const response = await fetch(endpoint, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${user.token}`,\r\n        },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (!response.ok) {\r\n        throw new Error(result.message || 'Failed to subscribe');\r\n      }\r\n\r\n      console.log('‚úÖ Subscription sent to Dicoding API:', result);\r\n      return result;\r\n    } catch (error) {\r\n      console.error('‚ùå Error sending subscription to Dicoding API:', error);\r\n      // Don't throw - subscription masih valid locally\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Delete Subscription from Dicoding API\r\n  // ========================================\r\n  async deleteSubscriptionFromDicodingAPI(subscription) {\r\n    try {\r\n      const user = JSON.parse(localStorage.getItem('dicoding_story_user') || '{}');\r\n\r\n      if (!user || !user.token) {\r\n        console.warn('‚ö†Ô∏è User belum login, skip delete subscription from API');\r\n        return;\r\n      }\r\n\r\n      const endpoint = `${CONFIG.BASE_URL}notifications/unsubscribe`;\r\n\r\n      console.log('üì§ Deleting subscription from Dicoding API:', endpoint);\r\n\r\n      const response = await fetch(endpoint, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${user.token}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const result = await response.json();\r\n        throw new Error(result.message || 'Failed to unsubscribe');\r\n      }\r\n\r\n      console.log('‚úÖ Subscription deleted from Dicoding API');\r\n    } catch (error) {\r\n      console.error('‚ùå Error deleting subscription from Dicoding API:', error);\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Test Notification (Local Only)\r\n  // ========================================\r\n  async testNotification() {\r\n    if (Notification.permission !== 'granted') {\r\n      await this.requestPermission();\r\n    }\r\n\r\n    if (Notification.permission === 'granted') {\r\n      const registration = await navigator.serviceWorker.ready;\r\n\r\n      registration.showNotification('Test Notification üß™', {\r\n        body: 'Ini adalah test notification dari Peta Wisata Indonesia',\r\n        icon: '/public/icons/icon-192x192.png',\r\n        badge: '/public/icons/icon-192x192.png',\r\n        tag: 'test-notification',\r\n        actions: [\r\n          { action: 'view', title: 'Lihat' },\r\n          { action: 'close', title: 'Tutup' },\r\n        ],\r\n        data: {\r\n          url: '/',\r\n        },\r\n      });\r\n\r\n      console.log('‚úÖ Test notification displayed');\r\n    }\r\n  },\r\n};\r\n\r\nexport default PushNotification;","import PushNotification from './push-notification.js';\r\n\r\nconst NotificationHelper = {\r\n  // ========================================\r\n  // Initialize Notification Toggle UI\r\n  // ========================================\r\n  async init() {\r\n    const toggleButton = document.getElementById('notificationToggle');\r\n    const icon = document.getElementById('notificationIcon');\r\n\r\n    if (!toggleButton) {\r\n      console.warn('Notification toggle button not found');\r\n      return;\r\n    }\r\n\r\n    // Check if push notification is supported\r\n    if (!PushNotification.isSupported()) {\r\n      toggleButton.style.display = 'none';\r\n      console.warn('Push notification not supported in this browser');\r\n      return;\r\n    }\r\n\r\n    // Update UI based on current status\r\n    await this.updateToggleUI();\r\n\r\n    // Add click listener\r\n    toggleButton.addEventListener('click', async () => {\r\n      await this.handleToggleClick();\r\n    });\r\n\r\n    console.log('‚úÖ Notification toggle initialized');\r\n  },\r\n\r\n  // ========================================\r\n  // Update Toggle UI\r\n  // ========================================\r\n  async updateToggleUI() {\r\n    const toggleButton = document.getElementById('notificationToggle');\r\n    const icon = document.getElementById('notificationIcon');\r\n\r\n    if (!toggleButton || !icon) return;\r\n\r\n    try {\r\n      const isSubscribed = await PushNotification.getSubscriptionStatus();\r\n      const permission = Notification.permission;\r\n\r\n      if (isSubscribed && permission === 'granted') {\r\n        icon.textContent = 'üîî'; // Bell ON\r\n        toggleButton.classList.add('active');\r\n        toggleButton.setAttribute('aria-label', 'Disable push notifications');\r\n        toggleButton.title = 'Notifikasi Aktif - Klik untuk nonaktifkan';\r\n      } else {\r\n        icon.textContent = 'üîï'; // Bell OFF\r\n        toggleButton.classList.remove('active');\r\n        toggleButton.setAttribute('aria-label', 'Enable push notifications');\r\n        toggleButton.title = 'Notifikasi Nonaktif - Klik untuk aktifkan';\r\n      }\r\n    } catch (error) {\r\n      console.error('Error updating toggle UI:', error);\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Handle Toggle Click\r\n  // ========================================\r\n  async handleToggleClick() {\r\n    const toggleButton = document.getElementById('notificationToggle');\r\n    \r\n    // Disable button sementara\r\n    toggleButton.disabled = true;\r\n    this.showLoading(true);\r\n\r\n    try {\r\n      const isSubscribed = await PushNotification.getSubscriptionStatus();\r\n\r\n      if (isSubscribed) {\r\n        // Unsubscribe\r\n        await PushNotification.unsubscribe();\r\n        this.showMessage('Notifikasi dinonaktifkan', 'success');\r\n      } else {\r\n        // Subscribe\r\n        await PushNotification.subscribe();\r\n        this.showMessage('Notifikasi diaktifkan! Anda akan menerima update terbaru.', 'success');\r\n      }\r\n\r\n      // Update UI\r\n      await this.updateToggleUI();\r\n    } catch (error) {\r\n      console.error('Error toggling notification:', error);\r\n      \r\n      if (error.message.includes('Permission')) {\r\n        this.showMessage('Izin notifikasi ditolak. Silakan aktifkan dari pengaturan browser.', 'error');\r\n      } else {\r\n        this.showMessage('Gagal mengaktifkan notifikasi. Silakan coba lagi.', 'error');\r\n      }\r\n    } finally {\r\n      toggleButton.disabled = false;\r\n      this.showLoading(false);\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Show Loading State\r\n  // ========================================\r\n  showLoading(show) {\r\n    const icon = document.getElementById('notificationIcon');\r\n    if (!icon) return;\r\n\r\n    if (show) {\r\n      icon.textContent = '‚è≥';\r\n    } else {\r\n      // Will be updated by updateToggleUI()\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Show Toast Message\r\n  // ========================================\r\n  showMessage(message, type = 'info') {\r\n    // Buat toast notification\r\n    const toast = document.createElement('div');\r\n    toast.className = `toast toast-${type}`;\r\n    toast.textContent = message;\r\n    toast.setAttribute('role', 'alert');\r\n\r\n    document.body.appendChild(toast);\r\n\r\n    // Show animation\r\n    setTimeout(() => {\r\n      toast.classList.add('show');\r\n    }, 100);\r\n\r\n    // Auto hide after 3 seconds\r\n    setTimeout(() => {\r\n      toast.classList.remove('show');\r\n      setTimeout(() => {\r\n        toast.remove();\r\n      }, 300);\r\n    }, 3000);\r\n  },\r\n\r\n  // ========================================\r\n  // Show Permission Dialog\r\n  // ========================================\r\n  showPermissionDialog() {\r\n    const dialog = document.createElement('div');\r\n    dialog.className = 'permission-dialog';\r\n    dialog.innerHTML = `\r\n      <div class=\"permission-dialog-content\">\r\n        <h3>üîî Aktifkan Notifikasi</h3>\r\n        <p>Dapatkan update terbaru tentang cerita wisata baru dan konten menarik lainnya.</p>\r\n        <div class=\"permission-dialog-actions\">\r\n          <button id=\"allowNotification\" class=\"btn-primary\">Izinkan</button>\r\n          <button id=\"denyNotification\" class=\"btn-secondary\">Nanti Saja</button>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    document.body.appendChild(dialog);\r\n\r\n    // Show animation\r\n    setTimeout(() => {\r\n      dialog.classList.add('show');\r\n    }, 100);\r\n\r\n    // Event listeners\r\n    document.getElementById('allowNotification')?.addEventListener('click', async () => {\r\n      dialog.remove();\r\n      await this.handleToggleClick();\r\n    });\r\n\r\n    document.getElementById('denyNotification')?.addEventListener('click', () => {\r\n      dialog.remove();\r\n    });\r\n  },\r\n\r\n  // ========================================\r\n  // Auto Prompt on First Visit\r\n  // ========================================\r\n  async autoPromptIfNeeded() {\r\n    // Cek apakah user sudah pernah diminta permission\r\n    const hasBeenPrompted = localStorage.getItem('notification_prompted');\r\n    \r\n    if (hasBeenPrompted) {\r\n      return;\r\n    }\r\n\r\n    // Tunggu 5 detik setelah page load\r\n    setTimeout(() => {\r\n      if (Notification.permission === 'default') {\r\n        this.showPermissionDialog();\r\n        localStorage.setItem('notification_prompted', 'true');\r\n      }\r\n    }, 5000);\r\n  },\r\n};\r\n\r\nexport default NotificationHelper;","const InstallPrompt = {\r\n  deferredPrompt: null,\r\n  isInstalled: false,\r\n\r\n  // ========================================\r\n  // Initialize Install Prompt\r\n  // ========================================\r\n  init() {\r\n    // Check if already installed\r\n    this.checkInstallStatus();\r\n\r\n    // Listen for beforeinstallprompt event\r\n    window.addEventListener('beforeinstallprompt', (e) => {\r\n      console.log('[Install] üíæ beforeinstallprompt event fired');\r\n      \r\n      // Prevent default browser prompt\r\n      e.preventDefault();\r\n      \r\n      // Store event for later use\r\n      this.deferredPrompt = e;\r\n      \r\n      // Show custom install button/banner\r\n      this.showInstallUI();\r\n    });\r\n\r\n    // Listen for appinstalled event\r\n    window.addEventListener('appinstalled', () => {\r\n      console.log('[Install] ‚úÖ PWA installed successfully');\r\n      this.isInstalled = true;\r\n      this.hideInstallUI();\r\n      this.deferredPrompt = null;\r\n      \r\n      // Save to localStorage\r\n      localStorage.setItem('pwa_installed', 'true');\r\n      \r\n      // Show success message\r\n      this.showSuccessMessage();\r\n    });\r\n\r\n    // Check if running in standalone mode (already installed)\r\n    if (window.matchMedia('(display-mode: standalone)').matches) {\r\n      console.log('[Install] üì± Running in standalone mode');\r\n      this.isInstalled = true;\r\n      this.hideInstallUI();\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Check Install Status\r\n  // ========================================\r\n  checkInstallStatus() {\r\n    // Check from localStorage\r\n    const wasInstalled = localStorage.getItem('pwa_installed') === 'true';\r\n    \r\n    // Check if running as standalone\r\n    const isStandalone = window.matchMedia('(display-mode: standalone)').matches;\r\n    \r\n    // iOS Safari\r\n    const isIOSStandalone = window.navigator.standalone === true;\r\n    \r\n    this.isInstalled = wasInstalled || isStandalone || isIOSStandalone;\r\n    \r\n    if (this.isInstalled) {\r\n      console.log('[Install] ‚úÖ App already installed');\r\n      this.hideInstallUI();\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Show Install UI\r\n  // ========================================\r\n  showInstallUI() {\r\n    // Create install banner\r\n    const existingBanner = document.getElementById('install-banner');\r\n    if (existingBanner) {\r\n      existingBanner.style.display = 'flex';\r\n      return;\r\n    }\r\n\r\n    const banner = document.createElement('div');\r\n    banner.id = 'install-banner';\r\n    banner.className = 'install-banner';\r\n    banner.innerHTML = `\r\n      <div class=\"install-banner-content\">\r\n        <div class=\"install-icon\">üì±</div>\r\n        <div class=\"install-text\">\r\n          <strong>Install Peta Wisata</strong>\r\n          <p>Akses lebih cepat dan bisa offline</p>\r\n        </div>\r\n        <button id=\"install-button\" class=\"install-btn\">Install</button>\r\n        <button id=\"install-close\" class=\"install-close\" aria-label=\"Close\">‚úï</button>\r\n      </div>\r\n    `;\r\n\r\n    document.body.appendChild(banner);\r\n\r\n    // Show animation\r\n    setTimeout(() => {\r\n      banner.classList.add('show');\r\n    }, 500);\r\n\r\n    // Add event listeners\r\n    document.getElementById('install-button')?.addEventListener('click', () => {\r\n      this.promptInstall();\r\n    });\r\n\r\n    document.getElementById('install-close')?.addEventListener('click', () => {\r\n      this.hideInstallUI();\r\n      // Don't show again for 7 days\r\n      localStorage.setItem('install_prompt_dismissed', Date.now().toString());\r\n    });\r\n  },\r\n\r\n  // ========================================\r\n  // Hide Install UI\r\n  // ========================================\r\n  hideInstallUI() {\r\n    const banner = document.getElementById('install-banner');\r\n    if (banner) {\r\n      banner.classList.remove('show');\r\n      setTimeout(() => {\r\n        banner.remove();\r\n      }, 300);\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Prompt Install\r\n  // ========================================\r\n  async promptInstall() {\r\n    if (!this.deferredPrompt) {\r\n      console.warn('[Install] ‚ö†Ô∏è Install prompt not available');\r\n      \r\n      // Show manual install instructions\r\n      this.showManualInstructions();\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Show install prompt\r\n      this.deferredPrompt.prompt();\r\n\r\n      // Wait for user choice\r\n      const { outcome } = await this.deferredPrompt.userChoice;\r\n      \r\n      console.log('[Install] User choice:', outcome);\r\n\r\n      if (outcome === 'accepted') {\r\n        console.log('[Install] ‚úÖ User accepted install');\r\n        this.hideInstallUI();\r\n      } else {\r\n        console.log('[Install] ‚ùå User dismissed install');\r\n      }\r\n\r\n      // Clear deferred prompt\r\n      this.deferredPrompt = null;\r\n    } catch (error) {\r\n      console.error('[Install] Error prompting install:', error);\r\n    }\r\n  },\r\n\r\n  // ========================================\r\n  // Show Manual Instructions (untuk iOS)\r\n  // ========================================\r\n  showManualInstructions() {\r\n    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);\r\n    \r\n    let instructions = '';\r\n    \r\n    if (isIOS) {\r\n      instructions = `\r\n        <div class=\"install-instructions\">\r\n          <h3>üì± Cara Install di iOS</h3>\r\n          <ol>\r\n            <li>Tap tombol <strong>Share</strong> (ikon kotak dengan panah ke atas)</li>\r\n            <li>Scroll ke bawah dan tap <strong>\"Add to Home Screen\"</strong></li>\r\n            <li>Tap <strong>\"Add\"</strong> di pojok kanan atas</li>\r\n          </ol>\r\n        </div>\r\n      `;\r\n    } else {\r\n      instructions = `\r\n        <div class=\"install-instructions\">\r\n          <h3>üíª Cara Install</h3>\r\n          <p>Gunakan menu browser:</p>\r\n          <ul>\r\n            <li><strong>Chrome:</strong> Menu (‚ãÆ) ‚Üí Install app / Add to Home screen</li>\r\n            <li><strong>Edge:</strong> Menu (‚ãØ) ‚Üí Apps ‚Üí Install this site as an app</li>\r\n            <li><strong>Firefox:</strong> Address bar ‚Üí Install icon</li>\r\n          </ul>\r\n        </div>\r\n      `;\r\n    }\r\n\r\n    // Create modal\r\n    const modal = document.createElement('div');\r\n    modal.className = 'install-modal';\r\n    modal.innerHTML = `\r\n      <div class=\"install-modal-content\">\r\n        ${instructions}\r\n        <button class=\"install-btn\" onclick=\"this.closest('.install-modal').remove()\">\r\n          Mengerti\r\n        </button>\r\n      </div>\r\n    `;\r\n\r\n    document.body.appendChild(modal);\r\n\r\n    // Close on backdrop click\r\n    modal.addEventListener('click', (e) => {\r\n      if (e.target === modal) {\r\n        modal.remove();\r\n      }\r\n    });\r\n  },\r\n\r\n  // ========================================\r\n  // Show Success Message\r\n  // ========================================\r\n  showSuccessMessage() {\r\n    const toast = document.createElement('div');\r\n    toast.className = 'install-toast';\r\n    toast.innerHTML = `\r\n      <div class=\"install-toast-content\">\r\n        ‚úÖ Aplikasi berhasil diinstall!\r\n      </div>\r\n    `;\r\n\r\n    document.body.appendChild(toast);\r\n\r\n    setTimeout(() => {\r\n      toast.classList.add('show');\r\n    }, 100);\r\n\r\n    setTimeout(() => {\r\n      toast.classList.remove('show');\r\n      setTimeout(() => {\r\n        toast.remove();\r\n      }, 300);\r\n    }, 3000);\r\n  },\r\n\r\n  // ========================================\r\n  // Check if should show prompt\r\n  // ========================================\r\n  shouldShowPrompt() {\r\n    // Don't show if already installed\r\n    if (this.isInstalled) {\r\n      return false;\r\n    }\r\n\r\n    // Don't show if dismissed recently (7 days)\r\n    const dismissedTime = localStorage.getItem('install_prompt_dismissed');\r\n    if (dismissedTime) {\r\n      const daysSinceDismissed = (Date.now() - parseInt(dismissedTime)) / (1000 * 60 * 60 * 24);\r\n      if (daysSinceDismissed < 7) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  },\r\n};\r\n\r\nexport default InstallPrompt;","import '../styles/styles.css';\nimport App from './pages/app.js';\nimport swRegister from './utils/sw-register.js';\nimport NotificationHelper from './utils/notification-helper.js';\nimport InstallPrompt from './utils/install-prompt.js';\n\nconsole.log('App initialized...');\n\nlet app;\n\nconst updateNav = () => {\n  const user = JSON.parse(localStorage.getItem('dicoding_story_user') || 'null');\n  const nav = document.querySelector('#nav-links');\n  if (!nav) return;\n  \n  if (user) {\n    nav.classList.add('logged-in');\n    nav.classList.remove('logged-out');\n  } else {\n    nav.classList.add('logged-out');\n    nav.classList.remove('logged-in');\n  }\n};\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  updateNav();\n  \n  app = new App({\n    button: document.querySelector('#hamburgerButton'),\n    drawer: document.querySelector('#navigationDrawer'),\n    content: document.querySelector('#main-content'),\n  });\n\n  const logoutBtn = document.querySelector('#logout-btn');\n  if (logoutBtn) {\n    logoutBtn.addEventListener('click', (e) => {\n      e.preventDefault();\n      if (confirm('Apakah Anda yakin ingin logout?')) {\n        localStorage.clear();\n        window.location.hash = '/';\n        updateNav();\n      }\n    });\n  }\n\n  window.addEventListener('hashchange', async () => {\n    console.log('Route changed:', window.location.hash);\n    await app.renderPage();\n    updateNav();\n  });\n\n  window.addEventListener('load', async () => {\n    console.log('Window loaded');\n    await app.renderPage();\n    \n    // üî• Register Service Worker\n    await swRegister();\n    \n    // üîî Initialize Push Notification (optional)\n    try {\n      await NotificationHelper.init();\n    } catch (error) {\n      console.warn('Notification init failed:', error);\n    }\n    \n    // üì± Initialize Install Prompt\n    InstallPrompt.init();\n  });\n});","/* eslint-disable no-console */\r\n\r\nconst swRegister = async () => {\r\n  // Pastikan browser mendukung service worker\r\n  if (!('serviceWorker' in navigator)) {\r\n    console.warn('‚ö†Ô∏è Service Worker tidak didukung di browser ini.');\r\n    return;\r\n  }\r\n\r\n  // Abaikan pendaftaran SW di mode development HTTPS\r\n  const isLocalhost = Boolean(\r\n    window.location.hostname === 'localhost' ||\r\n    window.location.hostname === '[::1]' ||\r\n    window.location.hostname.match(/^127(?:\\.\\d{1,3}){3}$/)\r\n  );\r\n\r\n  if (isLocalhost) {\r\n    console.log('üß© Mode development terdeteksi (localhost). SW tetap dijalankan untuk testing.');\r\n  }\r\n\r\n  try {\r\n    // Path service worker harus sesuai dengan hasil build webpack\r\n    const registration = await navigator.serviceWorker.register('/sw.js');\r\n\r\n    console.log('‚úÖ Service Worker registered successfully.');\r\n    console.log('Scope:', registration.scope);\r\n\r\n    // Deteksi jika ada update SW baru\r\n    registration.onupdatefound = () => {\r\n      const installingWorker = registration.installing;\r\n      if (installingWorker) {\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              console.log('üîÑ Update baru tersedia untuk Service Worker.');\r\n              // Kirim pesan agar SW baru segera aktif tanpa reload manual\r\n              installingWorker.postMessage({ type: 'SKIP_WAITING' });\r\n              // Setelah skip waiting, reload halaman otomatis agar gunakan SW baru\r\n              installingWorker.addEventListener('statechange', () => {\r\n                if (installingWorker.state === 'activated') {\r\n                  window.location.reload();\r\n                }\r\n              });\r\n            } else {\r\n              console.log('üéâ Service Worker siap untuk penggunaan offline.');\r\n            }\r\n          }\r\n        };\r\n      }\r\n    };\r\n\r\n    // Log jika ada SW aktif\r\n    if (navigator.serviceWorker.controller) {\r\n      console.log('üí° Active Service Worker found.');\r\n    }\r\n\r\n  } catch (error) {\r\n    console.error('‚ùå Service Worker registration failed:', error);\r\n    // Jika error karena \"storage\" atau permission, tangani gracefully\r\n    if (error.message && error.message.includes('storage')) {\r\n      console.warn('‚ö†Ô∏è Failed to access storage. Coba clear site data dari Application tab.');\r\n    }\r\n  }\r\n};\r\n\r\nexport default swRegister;\r\n"],"names":["init","button","drawer","content","console","error","this","_createOverlay","addEventListener","event","stopPropagation","_toggleDrawer","log","navLinks","querySelectorAll","length","forEach","link","index","href","setTimeout","_closeDrawer","document","key","overlay","getElementById","classList","contains","add","body","style","overflow","remove","createElement","id","className","appendChild","parseActiveUrlWithCombiner","url","window","location","hash","slice","toLowerCase","splitedUrl","_urlSplitter","combiner","resource","verb","parseActiveUrlWithoutCombiner","startsWith","urlsSplits","replace","split","filter","Boolean","REGISTER","LOGIN","ALL_STORIES","ADD_STORY","DETAIL_STORY","DEFAULT_COORDINATE","DEFAULT_ZOOM","PUBLIC_VAPID_KEY","SERVER_URL","USER_KEY","saveUser","user","localStorage","setItem","JSON","stringify","getUser","getItem","parse","registerUser","name","email","password","response","fetch","CONFIG","method","headers","result","json","ok","Error","message","loginUser","loginResult","token","getAllStories","Date","now","Authorization","listStory","addStory","description","photo","lat","lon","formData","FormData","append","getStoryDetail","story","getUserProfile","STORE_NAME","openDatabase","Promise","resolve","reject","request","indexedDB","open","onerror","onsuccess","target","onupgradeneeded","db","objectStoreNames","createObjectStore","keyPath","createIndex","unique","addFavorite","favoriteData","photoUrl","createdAt","toISOString","transaction","objectStore","put","getAllFavorites","getAll","getFavorite","get","deleteFavorite","delete","isFavorite","toggleFavorite","HomePage","async","render","afterRender","map","L","setView","tileLayer","attribution","addTo","markerLayer","layerGroup","reloadBtn","querySelector","disabled","innerHTML","_loadStories","stories","API","storyList","clearLayers","storyElement","storyId","heartIcon","FavoriteIDB","toLocaleDateString","day","month","year","substring","favoriteBtn","e","preventDefault","isNowFavorited","textContent","_showNotification","marker","bindPopup","includes","removeItem","type","notification","cssText","animation","form","errorDiv","value","trim","alert","selectedLat","selectedLng","initMapPicker","on","lng","latlng","removeLayer","onLocationSelect","photoInput","files","showSuccessNotification","warn","permission","Notification","requestPermission","navigator","registration","serviceWorker","ready","showNotification","icon","badge","tag","requireInteraction","vibrate","data","timestamp","actions","action","title","UrlParser","rawHash","initMapForStory","_loadFavorites","favoritesList","favoritesCount","favorites","dataset","_initRemoveButtons","confirm","constructor","_button","_drawer","_content","_initAppShell","DrawerInitiator","renderPage","page","routes","startViewTransition","isSupported","urlBase64ToUint8Array","base64String","base64","repeat","rawData","atob","outputArray","Uint8Array","i","charCodeAt","subscribe","subscription","pushManager","getSubscription","sendSubscriptionToDicodingAPI","vapidPublicKey","convertedVapidKey","userVisibleOnly","applicationServerKey","unsubscribe","deleteSubscriptionFromDicodingAPI","getSubscriptionStatus","subscriptionJSON","toJSON","payload","endpoint","keys","p256dh","auth","testNotification","toggleButton","PushNotification","display","updateToggleUI","handleToggleClick","isSubscribed","setAttribute","showLoading","showMessage","show","toast","showPermissionDialog","dialog","autoPromptIfNeeded","deferredPrompt","isInstalled","checkInstallStatus","showInstallUI","hideInstallUI","showSuccessMessage","matchMedia","matches","wasInstalled","isStandalone","isIOSStandalone","standalone","existingBanner","banner","promptInstall","toString","showManualInstructions","prompt","outcome","userChoice","instructions","test","userAgent","modal","shouldShowPrompt","dismissedTime","parseInt","app","updateNav","nav","App","logoutBtn","clear","hostname","match","register","scope","onupdatefound","installingWorker","installing","onstatechange","state","controller","postMessage","reload","swRegister","NotificationHelper","InstallPrompt"],"sourceRoot":""}